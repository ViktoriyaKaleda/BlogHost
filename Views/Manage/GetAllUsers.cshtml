@model BlogHosting.Models.PageNavigationViewModels.UsersPageViewModel
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@{
    ViewData["Title"] = "GetAllUsers";
}

<h2>Registered users</h2>

<a asp-action="CreateUser">Create new</a>
<hr />

<table class="table">
    <tr><th>Avatar</th><th>Username</th><th>Email</th><th></th></tr>
    @foreach (var user in Model.Users)
    {
        <tr>
            <td>
                <div class="media-left">
                    <img class="avatar" style=" width: 50px; height: 50px;" src="@Url.Content(user.AvatarPath ?? "~/Avatars/default.png")">
                </div>
            </td>
            <td>@user.UserName</td>
            <td>@user.Email</td>
            <td>
                <a class="btn btn-sm btn-primary" asp-action="Index" asp-route-username="@user.UserName">Изменить</a>
                <a class="btn btn-sm btn-danger" asp-action="Delete" asp-route-id="@user.Id">Удалить</a>
            </td>
        </tr>
    }
</table>

<div class="container text-left">
    @if (Model.PageViewModel.PageNumber > 3)
    {
        <a asp-action="GetAllUsers" asp-route-page="1" class="btn btn-default btn">
            <i class="glyphicon glyphicon-chevron-left"></i>
            @Localizer["To start"]
        </a>
    }
    @{
        int i;
        for (i = Model.PageViewModel.PageNumber - 2 < 2 ? 1 : Model.PageViewModel.PageNumber - 2;
            i <= Model.PageViewModel.TotalPages && i <= Model.PageViewModel.PageNumber + 3; i++)
        {
            @if (i == Model.PageViewModel.PageNumber + 3)
            {
                if (i != Model.PageViewModel.TotalPages)
                {
                    <text>...</text>
                }
                <a asp-action="GetAllUsers" asp-route-page="@Model.PageViewModel.TotalPages" class="btn btn-default btn">@Model.PageViewModel.TotalPages</a>
                break;
            }
            @if (i == Model.PageViewModel.PageNumber)
            {
                <a asp-action="GetAllUsers" asp-route-page="@(i)" class="btn btn-info btn">@i</a>
            }
            else
            {
                <a asp-action="GetAllUsers" asp-route-page="@(i)" class="btn btn-default btn">@i</a>
            }
        }
        if (Model.PageViewModel.PageNumber < Model.PageViewModel.TotalPages)
        {
            <a asp-action="GetAllUsers" asp-route-page="@(Model.PageViewModel.PageNumber + 1)" class="btn btn-default btn">
                @Localizer["Next"]
                <i class="glyphicon glyphicon-chevron-right"></i>
            </a>
        }
    }
</div>